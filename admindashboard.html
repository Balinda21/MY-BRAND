<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="blogs.css">
  <link rel="stylesheet" href="admindashboard.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
</head>
<body>
  <header class="admin-header">
    <div>
      <h3>Admin Dashboard</h3>
    </div>
    <div style="display: flex; gap: 10px;">
      <div><img src="./images/dash.jpg" alt="" style=" width: 50px; height: 45px; border-radius: 500px;"></div>
      <div><h4>Maurice</h4></div>
    </div>
  </header>
  <input type="checkbox" id="check">
  <label for="check">
    <i class="fas fa-bars" id="btn"></i>
    <i class="fas fa-times" id="cancel"></i>
  </label>
  <div class="sidebar">
    <header>Maurice</header>
    <a href="#" class="active">
      <i class="fas fa-qrcode"></i>
      <span>Dashboard</span>
    </a>
    <a href="#">
      <i class="fas fa-stream"></i>
      <span>Blogs</span>
    </a>
    <a href="addblog.html">
      <i class="fas fa-calendar"></i>
      <span>Add Blog</span>
    </a>
    <a href="adminqueries.html">
      <i class="fas fa-calendar"></i>
      <span>Queries</span>
    </a>
    <a href="index.html">
      <i class="fas fa-calendar"></i> 
      <span>Logout</span>
    </a>
  </div>

  <div class="card-holder">
    <div class="comments"> 
      Total comments: 300
    </div>
    <div class="likes">
      Total likes: 200
    </div>
  </div>

  <div class="blog-cards-container" id="blog-cards-container"></div>

  <!-- Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Edit Blog Post</h2>
      <form id="editForm">
        <label for="editTitle">Title:</label><br>
        <input type="text" id="editTitle" name="editTitle"><br>
        <label for="editDate">Date:</label><br>
        <input type="text" id="editDate" name="editDate"><br>
        <label for="editPicture">Picture URL:</label><br> <!-- New picture input field -->
        <input type="text" id="editPicture" name="editPicture"><br> <!-- New picture input field -->
        <label for="editDescription">Description:</label><br>
        <textarea id="editDescription" name="editDescription"></textarea><br>
        <button type="submit">Save Changes</button>
      </form>
    </div>
  </div>
  <script>
    // Function to generate HTML for blog post cards
    function generateBlogCard(blog) {
      const card = document.createElement('div');
      card.classList.add('blog-card');

      const image = document.createElement('img');
      image.src = blog.picture; // Replace with correct image source
      image.alt = 'Blog Picture';
      card.appendChild(image);

      const content = document.createElement('div');
      content.classList.add('card-content');

      const title = document.createElement('h2');
      title.textContent = blog.title;
      content.appendChild(title);

      const date = document.createElement('span');
      date.classList.add('card-date');
      date.textContent = blog.date;
      content.appendChild(date);

      const description = document.createElement('p');
      description.textContent = blog.description;
      content.appendChild(description);

      card.appendChild(content);

      const editButton = document.createElement('button');
      editButton.textContent = 'Edit';
      editButton.classList.add('edit-button');
      editButton.onclick = () => populateEditForm(blog); // Corrected function call
      card.appendChild(editButton);

      const deleteButton = document.createElement('button');
      deleteButton.textContent = 'Delete';
      deleteButton.classList.add('delete-button');
      deleteButton.onclick = () => deleteBlog(blog); // Corrected function call
      card.appendChild(deleteButton);

      return card;
    }

    // Function to update blog cards from local storage
    function updateBlogCards() {
      const blogCardsContainer = document.getElementById('blog-cards-container');
      blogCardsContainer.innerHTML = '';

      const blogs = JSON.parse(localStorage.getItem('blogs')) || [];
      blogs.forEach(blog => {
        const card = generateBlogCard(blog);
        blogCardsContainer.appendChild(card);
      });
    }

    // Function to populate edit form with blog details
    function populateEditForm(blog) {
      const editTitle = document.getElementById('editTitle');
      const editDate = document.getElementById('editDate');
      const editDescription = document.getElementById('editDescription');
      const editPicture = document.getElementById('editPicture'); // New picture input field

      editTitle.value = blog.title;
      editDate.value = blog.date;
      editDescription.value = blog.description;
      editPicture.value = blog.picture; // Populate picture input field with existing picture

      document.getElementById('editModal').style.display = 'block';
      document.getElementById('editForm').onsubmit = function(event) {
        event.preventDefault();

        const updatedTitle = editTitle.value;
        const updatedDate = editDate.value;
        const updatedDescription = editDescription.value;
        const updatedPicture = editPicture.value; // Get updated picture input

        let blogs = JSON.parse(localStorage.getItem('blogs')) || [];

        blogs.forEach((item, index) => {
          if (item.title === blog.title && item.date === blog.date && item.description === blog.description) {
            blogs[index] = {
              title: updatedTitle,
              date: updatedDate,
              description: updatedDescription,
              picture: updatedPicture // Update picture in the blog object
            };
          }
        });

        localStorage.setItem('blogs', JSON.stringify(blogs));

        document.getElementById('editModal').style.display = 'none';
        updateBlogCards();
      };
    }

    // Function to delete a blog post
    function deleteBlog(blog) {
      let blogs = JSON.parse(localStorage.getItem('blogs')) || [];
      blogs = blogs.filter(item => item.title !== blog.title); // Filter out the selected blog
      localStorage.setItem('blogs', JSON.stringify(blogs)); // Update local storage
      updateBlogCards(); // Update UI
    }

    // Close the modal when the user clicks on (x)
    const closeBtn = document.getElementsByClassName("close")[0];
    closeBtn.onclick = () => {
      document.getElementById("editModal").style.display = "none";
    }

    // Load existing blogs initially
    updateBlogCards();
</script>

  </body>
</html>
